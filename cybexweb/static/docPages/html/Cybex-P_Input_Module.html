

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Cybex-P Input Module &mdash; cybex_web_app 0.9.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script >mermaid.initialize({startOnLoad:true});</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cybex-P API Module" href="Cybex-P_API_Module.html" />
    <link rel="prev" title="The Cybex-P backend" href="The_Cybex-P_Backend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> cybex_web_app
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Front End</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Web Application</a></li>
</ul>
<p class="caption"><span class="caption-text">Back End</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="The_Cybex-P_Backend.html">The Cybex-P Backend</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cybex-P Input Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_API_Module.html">Cybex-P API Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_API_Module.html#small-common-small"><small> Common</small></a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_API_Module.html#small-config-small"><small>config</small></a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_API_Module.html#small-identity-small"><small> Identity </small></a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_Archive_Module.html">Cybex-P Archive_Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_Analytics_Module.html">Cybex-P Analytics Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_Report_Module.html">Cybex-P Report_Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_Installation_Guide.html">Cybex-P Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cybex-P_Installation_Guide.html#cybex-p-database-overview">Cybex-P Database Overview</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cybex.cse.unr.edu/backendapi">Interactive Backend API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cybex_web_app</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Cybex-P Input Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Cybex-P_Input_Module.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cybex-p-input-module">
<h1>Cybex-P Input Module<a class="headerlink" href="#cybex-p-input-module" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code> is reponsible for the collection of threat data provided from user input and to populate it into the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>. The Input module is located Inside the collector server and in between the frontend client and <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>.  Users can manually post threat data through the frontend web client or let handling be done automatically via the connector server to the collector.</p>
<p>Examples of automatic data collection include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Calling an API</p></li>
<li><p>A pre-configured websocket</p></li>
<li><p>reading from a text file</p></li>
<li><p>reading from a database</p></li>
<li><p>Using linux syslog protocol</p></li>
</ul>
</div></blockquote>
<p>The following flow chart is a smaller scale summarization of the flow of data to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code> via the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code>:</p>
<div class="mermaid">
            graph TD
A[Automatically Collected Data] --&gt; E((Connector Server)) --&gt; F((Collector Server)) --&gt; D 
B[User webapp Inputted Data] --&gt; G((Frontend Server))
G --&gt; D[Cybex-P API Module]
H[Cache Data Lake]

D --&gt; H
I[...]
H --Data Continues further--&gt; I

        </div><div class="section" id="cybex-p-input-repository">
<h2>Cybex-P Input Repository<a class="headerlink" href="#cybex-p-input-repository" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code>handles all kinds of data incoming to CYBEX-P. Users can manually upload threat data via a web client or automatically send machine data via a connector to the collector.</p>
<p>The module is compromised of multiple <em><strong>plugins</strong></em> to handle inputs. Plugins are their own seperate add-ons and each plugin handles one type of source (e.g. Cowrie honeypot).</p>
<p>Files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input.py</span></code></p>
<ul>
<li><p>This is the main file to start, stop or restart the input module. This file passes the start/stop/restart command to <code class="docutils literal notranslate"><span class="pre">run.py</span></code> and exits itself.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">run.py</span></code></p>
<ul>
<li><p>This script keeps continuously running in the background. The <code class="docutils literal notranslate"><span class="pre">input.py</span></code> file starts this script as a process/fork and exits. The <code class="docutils literal notranslate"><span class="pre">run.py</span></code> creates an websocket and saves that info in the runningconfig file in the working directory. It also as functions to start/stop/restart specific plugins or inputs.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">runningconfig</span></code></p>
<ul>
<li><p>A text file created by <code class="docutils literal notranslate"><span class="pre">run.py</span></code> and deleted during normal exit. This file contains the host, port of the websocket used by <code class="docutils literal notranslate"><span class="pre">input.py</span></code>  to pass commands to <code class="docutils literal notranslate"><span class="pre">run.py</span></code>  (IPC).</p></li>
</ul>
</li>
</ul>
<p>There are currently six plugins in the input module; four of the plugins are open source threat intelligence platforms while the other two plugins are entities that are fully native to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code>. The  <em><strong>plugins</strong></em> themselves are comprosed of the following services:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">common</span></code></p>
<ul>
<li><p>Cybex Source Fetching, Exponential backoff, Cybex Sources. Common plugin module used by the other modules</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">misp_api</span></code></p>
<ul>
<li><p>MISP api with python wrapper. Malware information sharing platform; Open source threat intelligence</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">misp_file</span></code></p>
<ul>
<li><p>MISP file input</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">openphish</span></code></p>
<ul>
<li><p>phishing intelligence platform</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">phishtank</span></code></p>
<ul>
<li><p>Gets phishing URLs from phishtank.com.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">websocket</span></code></p>
<ul>
<li><p>Lomond websocket plugin</p></li>
</ul>
</li>
</ul>
<p>Below is a general diagram of how threat data is handled by the various plugins in the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code>:</p>
<div class="mermaid">
            graph
A[Threat data] --&gt; B((Common:&lt;br&gt; Base Cybex &lt;br&gt; source fetcher)) --&gt; H[Cybex-P API Module]
A[Threat data] --&gt; C((misp_api:&lt;br&gt; MISP threat&lt;br&gt; intelligence API)) --&gt; H[Cybex-P API Module]
A[Threat data] --&gt; D((misp_file:&lt;br&gt; MISP file input)) --&gt; H[Cybex-P API Module]
A[Threat data] --&gt; E((openphish:&lt;br&gt; Phishing intel &lt;br&gt; patform)) --&gt; H[Cybex-P API Module]
A[Threat data] --&gt; F((phishtank:&lt;br&gt; Community &lt;br&gt; phishing intel &lt;br&gt; platform)) --&gt; H[Cybex-P API Module]
A[Threat data] --&gt; G((websocket:&lt;br&gt; Cybex-P General &lt;br&gt;websocket)) --&gt; H[Cybex-P API Module]

        </div></div>
<div class="section" id="plugins">
<h2>Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
<li></li>
</ul>
<div class="section" id="common">
<h3>Common<a class="headerlink" href="#common" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>As it’s name states, <code class="docutils literal notranslate"><span class="pre">common</span></code> is a module that contains common utility and functions that is used by the other plugins within the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code>.  The following are classes utilized by the other plugins to handle data:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>CybexSource()</p></li>
<li><p>CybexSourceFectcher()</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><em><strong>CybexSource()</strong></em> is <code class="docutils literal notranslate"><span class="pre">common</span></code>’s class that is responsible for validating input configuration and posting Cybex-P <em><strong>events</strong></em> to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>. All modules within the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code> inherit this class due to the responsibility of posting data to the api being on this module.</p></li>
<li><p><em><strong>CybexSourceFetch()</strong></em> is an additional class in <code class="docutils literal notranslate"><span class="pre">common</span></code> that serves to handle the rate of input from input sources provided by <em><strong>CybexSource()</strong></em>. It executes signal events in multiple threads and executes the signals in those threads based on certain conditions.</p></li>
</ul>
</div>
<div class="section" id="misp-api">
<h3>misp_api<a class="headerlink" href="#misp-api" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Malware Information Share Platform (or MISP) is an open-source platform that provides information on the threat levels and malicious capabilities of threat data provided to it. <code class="docutils literal notranslate"><span class="pre">misp_api</span></code> is a Cybex-P integration of the platform which utilizes the projects API endpoint to populate Cybex-P’s backend with additional data on any provided threat attribute. The project is integrated into the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">Input</span> <span class="pre">Module</span></code> by a python wrapper of the platform. The plugin works by simply taking the provided threat data and posting it to the platforms endpoint; the response data, provided it isn’t an error, proceeds to get posted to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>.</p></li>
</ul>
</div>
<div class="section" id="misp-file">
<h3>misp_file<a class="headerlink" href="#misp-file" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>This plugin acts as a direct input of MISP data. Users who have files available that come from MISP can be inputted through this plugin and easily populated to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>.</p></li>
</ul>
</div>
<div class="section" id="openphish">
<h3>openphish<a class="headerlink" href="#openphish" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>the openphish plugin is a Cybex-P input plugin that actively retrieves URL sources from the openphish platform for the Cybex-P backend. Openphish is a phishing intelligence source that consistently gets updated with URLs that have been flagged as phishing links. This data is populated to the backend of Cybex-P and used as additional attribute data that is correlated to other threat data and sources that is provided to the backend.</p></li>
</ul>
</div>
<div class="section" id="phishtank">
<h3>phishtank<a class="headerlink" href="#phishtank" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>like openphish, phishtank is another phishing intelligence platform that offers a community-based phish verification system and users get to vote if the URL should be flagged as a phish. like openphish, phishtank calls are consistently made and data is returned, compressed, in either .bz2 or .gz extension. The data then gets decompressed and comes out in the form a list of records from phishtank. All provided records get posted to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code>.</p></li>
</ul>
</div>
<div class="section" id="websocket">
<h3>websocket<a class="headerlink" href="#websocket" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>the websocket plugin is a general purpose plugin with no specific specification directly attached to it. This plugin is used for all other miscellaneous forms of threat data collection. This plugin establishes a connection to the <code class="docutils literal notranslate"><span class="pre">Cybex-P</span> <span class="pre">API</span> <span class="pre">Module</span></code> using lomond websocket protocol ws. Use it to connect to the log stash socket module.  The log stash provides information on threat data.</p></li>
</ul>
</div>
</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li></li>
<li></li>
</ul>
<div class="section" id="pluginhandler">
<h3>PluginHandler<a class="headerlink" href="#pluginhandler" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>deals with the handling of any threads spun up</p></li>
</ul>
</div>
<div class="section" id="pluginmanager">
<h3>PluginManager<a class="headerlink" href="#pluginmanager" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>takes care and maintains the sockets of the cybex-p input module, these methods include:</p>
<ul>
<li><p>Updating socket configurations</p></li>
<li><p>Spawning configurations</p></li>
<li><p>Restarting sockets</p></li>
<li><p>Killing sockets</p></li>
<li><p>Checking on the running configs</p></li>
<li><p>Initiating and updating to new configs</p></li>
<li><p>Running input plugins</p></li>
<li><p>Retrieving configurations from files</p></li>
<li><p>running the files of input plugins</p></li>
<li><p>handling changins</p></li>
<li><p>removing stale sockets</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Cybex-P_API_Module.html" class="btn btn-neutral float-right" title="Cybex-P API Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="The_Cybex-P_Backend.html" class="btn btn-neutral float-left" title="The Cybex-P backend" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Adam Cassell.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>