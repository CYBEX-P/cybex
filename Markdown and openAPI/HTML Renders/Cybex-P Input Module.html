<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cybex-P Input Module</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="cybex-p-input-module">Cybex-P Input Module</h1>
<p>The <code>Cybex-P Input Module</code> is reponsible for the collection of threat data provided from user input and to populate it into the <code>Cybex-P API Module</code>. The Input module is located Inside the collector server and in between the frontend client and <code>Cybex-P API Module</code>.  Users can manually post threat data through the frontend web client or let handling be done automatically via the connector server to the collector.</p>
<p>Examples of automatic data collection include:</p>
<blockquote>
<ul>
<li>Calling an API</li>
<li>A pre-configured websocket</li>
<li>reading from a text file</li>
<li>reading from a database</li>
<li>Using linux syslog protocol</li>
</ul>
</blockquote>
<p>The following flow chart is a smaller scale summarization of the flow of data to the <code>Cybex-P API Module</code> via the <code>Cybex-P Input Module</code>:</p>
<pre class=" language-mermaid"><svg id="mermaid-svg-rTq2y15vfrDjLxKE" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="758.6563110351562" style="max-width: 469.14239501953125px;" viewBox="0.00000762939453125 0.0000019073486328125 469.14239501953125 758.6563110351562"><style>#mermaid-svg-rTq2y15vfrDjLxKE{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-rTq2y15vfrDjLxKE .error-icon{fill:#552222;}#mermaid-svg-rTq2y15vfrDjLxKE .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-rTq2y15vfrDjLxKE .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-rTq2y15vfrDjLxKE .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-rTq2y15vfrDjLxKE .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-rTq2y15vfrDjLxKE .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-rTq2y15vfrDjLxKE .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-rTq2y15vfrDjLxKE .marker{fill:#666;stroke:#666;}#mermaid-svg-rTq2y15vfrDjLxKE .marker.cross{stroke:#666;}#mermaid-svg-rTq2y15vfrDjLxKE svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-rTq2y15vfrDjLxKE .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-rTq2y15vfrDjLxKE .cluster-label text{fill:#333;}#mermaid-svg-rTq2y15vfrDjLxKE .cluster-label span{color:#333;}#mermaid-svg-rTq2y15vfrDjLxKE .label text,#mermaid-svg-rTq2y15vfrDjLxKE span{fill:#000000;color:#000000;}#mermaid-svg-rTq2y15vfrDjLxKE .node rect,#mermaid-svg-rTq2y15vfrDjLxKE .node circle,#mermaid-svg-rTq2y15vfrDjLxKE .node ellipse,#mermaid-svg-rTq2y15vfrDjLxKE .node polygon,#mermaid-svg-rTq2y15vfrDjLxKE .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-rTq2y15vfrDjLxKE .node .label{text-align:center;}#mermaid-svg-rTq2y15vfrDjLxKE .node.clickable{cursor:pointer;}#mermaid-svg-rTq2y15vfrDjLxKE .arrowheadPath{fill:#333333;}#mermaid-svg-rTq2y15vfrDjLxKE .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-rTq2y15vfrDjLxKE .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-rTq2y15vfrDjLxKE .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-rTq2y15vfrDjLxKE .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-rTq2y15vfrDjLxKE .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-rTq2y15vfrDjLxKE .cluster text{fill:#333;}#mermaid-svg-rTq2y15vfrDjLxKE .cluster span{color:#333;}#mermaid-svg-rTq2y15vfrDjLxKE div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-rTq2y15vfrDjLxKE:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-rTq2y15vfrDjLxKE flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-E" id="L-A-E" style="opacity: 1;"><path class="path" d="M123.10417175292969,54.66666793823242L123.10417175292969,79.66666793823242L123.10417175292969,104.66666793823242" marker-end="url(https://stackedit.io/app#arrowhead86)" style="fill:none"></path><defs><marker id="arrowhead86" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M123.10417175292969,248.34724044799805L123.10417175292969,273.34724044799805L123.10417175292969,298.34724044799805" marker-end="url(https://stackedit.io/app#arrowhead87)" style="fill:none"></path><defs><marker id="arrowhead87" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-D" id="L-F-D" style="opacity: 1;"><path class="path" d="M123.10417175292969,433.9896049499512L123.10417175292969,458.9896049499512L182.57121764259279,483.9896049499512" marker-end="url(https://stackedit.io/app#arrowhead88)" style="fill:none"></path><defs><marker id="arrowhead88" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-G" id="L-B-G" style="opacity: 1;"><path class="path" d="M353.04341888427734,199.84028816223145L353.04341888427734,273.34724044799805L353.04341888427734,298.7031440734863" marker-end="url(https://stackedit.io/app#arrowhead89)" style="fill:none"></path><defs><marker id="arrowhead89" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-D" id="L-G-D" style="opacity: 1;"><path class="path" d="M353.04341888427734,433.6337013244629L353.04341888427734,458.9896049499512L293.57637299461425,483.9896049499512" marker-end="url(https://stackedit.io/app#arrowhead90)" style="fill:none"></path><defs><marker id="arrowhead90" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-H" id="L-D-H" style="opacity: 1;"><path class="path" d="M238.07379531860352,530.6562728881836L238.07379531860352,555.6562728881836L238.07379531860352,580.6562728881836" marker-end="url(https://stackedit.io/app#arrowhead91)" style="fill:none"></path><defs><marker id="arrowhead91" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" id="L-H-I" style="opacity: 1;"><path class="path" d="M238.07379531860352,627.322940826416L238.07379531860352,665.6562747955322L238.07379531860352,703.9896087646484" marker-end="url(https://stackedit.io/app#arrowhead92)" style="fill:none"></path><defs><marker id="arrowhead92" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-E" class="edgeLabel L-LS-A' L-LE-E"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-F" class="edgeLabel L-LS-E' L-LE-F"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-D" class="edgeLabel L-LS-F' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-G" class="edgeLabel L-LS-B' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-D" class="edgeLabel L-LS-G' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-H" class="edgeLabel L-LS-D' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(238.07379531860352,665.6562747955322)" style="opacity: 1;"><g transform="translate(-82.00521087646484,-13.333333969116211)" class="label"><rect rx="0" ry="0" width="164.0104217529297" height="26.666667938232422"></rect><foreignObject width="164.0104217529297" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-H-I" class="edgeLabel L-LS-H' L-LE-I">Data Continues further</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-380" transform="translate(123.10417175292969,31.33333396911621)" style="opacity: 1;"><rect rx="0" ry="0" x="-115.10417175292969" y="-23.33333396911621" width="230.20834350585938" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-105.10417175292969,-13.333333969116211)"><foreignObject width="210.20834350585938" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Automatically Collected Data</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-381" transform="translate(123.10417175292969,176.50695419311523)" style="opacity: 1;"><circle x="-71.84028625488281" y="-23.33333396911621" r="71.84028625488281" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-61.84028625488281,-13.333333969116211)"><foreignObject width="123.6805648803711" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Connector Server</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-382" transform="translate(123.10417175292969,366.1684226989746)" style="opacity: 1;"><circle x="-67.82118225097656" y="-23.33333396911621" r="67.82118225097656" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-57.82118225097656,-13.333333969116211)"><foreignObject width="115.64236450195312" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Collector Server</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-383" transform="translate(238.07379531860352,507.3229389190674)" style="opacity: 1;"><rect rx="0" ry="0" x="-80.703125" y="-23.33333396911621" width="161.40625" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-70.703125,-13.333333969116211)"><foreignObject width="141.40625" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cybex-P API Module</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-384" transform="translate(353.04341888427734,176.50695419311523)" style="opacity: 1;"><rect rx="0" ry="0" x="-108.09896087646484" y="-23.33333396911621" width="216.1979217529297" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-98.09896087646484,-13.333333969116211)"><foreignObject width="196.1979217529297" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">User webapp Inputted Data</div></foreignObject></g></g></g><g class="node default" id="flowchart-G-385" transform="translate(353.04341888427734,366.1684226989746)" style="opacity: 1;"><circle x="-67.46527862548828" y="-23.33333396911621" r="67.46527862548828" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-57.46527862548828,-13.333333969116211)"><foreignObject width="114.93055725097656" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Frontend Server</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-388" transform="translate(238.07379531860352,603.9896068572998)" style="opacity: 1;"><rect rx="0" ry="0" x="-69.64410018920898" y="-23.33333396911621" width="139.28820037841797" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-59.644100189208984,-13.333333969116211)"><foreignObject width="119.28820037841797" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cache Data Lake</div></foreignObject></g></g></g><g class="node default" id="flowchart-I-391" transform="translate(238.07379531860352,727.3229427337646)" style="opacity: 1;"><rect rx="0" ry="0" x="-18.81944465637207" y="-23.33333396911621" width="37.63888931274414" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-8.81944465637207,-13.333333969116211)"><foreignObject width="17.63888931274414" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">...</div></foreignObject></g></g></g></g></g></g></svg></pre>
<h1 id="cybex-p-input-repository">Cybex-P Input Repository</h1>
<p>The <code>Cybex-P Input Module</code>handles all kinds of data incoming to CYBEX-P. Users can manually upload threat data via a web client or automatically send machine data via a connector to the collector.</p>
<p>The module is compromised of multiple <em><strong>plugins</strong></em> to handle inputs. Plugins are their own seperate add-ons and each plugin handles one type of source (e.g. Cowrie honeypot).</p>
<p>Files:</p>
<ul>
<li><code>input.py</code>
<ul>
<li>This is the main file to start, stop or restart the input module. This file passes the start/stop/restart command to <code>run.py</code> and exits itself.</li>
</ul>
</li>
<li><code>run.py</code>
<ul>
<li>This script keeps continuously running in the background. The <code>input.py</code> file starts this script as a process/fork and exits. The <code>run.py</code> creates an websocket and saves that info in the runningconfig file in the working directory. It also as functions to start/stop/restart specific plugins or inputs.</li>
</ul>
</li>
<li><code>runningconfig</code>
<ul>
<li>A text file created by <code>run.py</code> and deleted during normal exit. This file contains the host, port of the websocket used by <code>input.py</code>  to pass commands to <code>run.py</code>  (IPC).</li>
</ul>
</li>
</ul>
<p>There are currently six plugins in the input module; four of the plugins are open source threat intelligence platforms while the other two plugins are entities that are fully native to the <code>Cybex-P Input Module</code>. The  <em><strong>plugins</strong></em> themselves are comprosed of the following services:</p>
<ul>
<li><code>common</code>
<ul>
<li>Cybex Source Fetching, Exponential backoff, Cybex Sources. Common plugin module used by the other modules</li>
</ul>
</li>
<li><code>misp_api</code>
<ul>
<li>MISP api with python wrapper. Malware information sharing platform; Open source threat intelligence</li>
</ul>
</li>
<li><code>misp_file</code>
<ul>
<li>MISP file input</li>
</ul>
</li>
<li><code>openphish</code>
<ul>
<li>phishing intelligence platform</li>
</ul>
</li>
<li><code>phishtank</code>
<ul>
<li>Gets phishing URLs from <a href="http://phishtank.com">phishtank.com</a>.</li>
</ul>
</li>
<li><code>websocket</code>
<ul>
<li>Lomond websocket plugin</li>
</ul>
</li>
</ul>
<p>Below is a general diagram of how threat data is handled by the various plugins in the <code>Cybex-P Input Module</code>:</p>
<pre class=" language-mermaid"><svg id="mermaid-svg-ZJiA1ixGWdsW7rQo" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="353.2569274902344" style="max-width: 1036.9376220703125px;" viewBox="0 0.0000019073486328125 1036.9376220703125 353.2569274902344"><style>#mermaid-svg-ZJiA1ixGWdsW7rQo{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-ZJiA1ixGWdsW7rQo .error-icon{fill:#552222;}#mermaid-svg-ZJiA1ixGWdsW7rQo .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-ZJiA1ixGWdsW7rQo .marker{fill:#666;stroke:#666;}#mermaid-svg-ZJiA1ixGWdsW7rQo .marker.cross{stroke:#666;}#mermaid-svg-ZJiA1ixGWdsW7rQo svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-ZJiA1ixGWdsW7rQo .cluster-label text{fill:#333;}#mermaid-svg-ZJiA1ixGWdsW7rQo .cluster-label span{color:#333;}#mermaid-svg-ZJiA1ixGWdsW7rQo .label text,#mermaid-svg-ZJiA1ixGWdsW7rQo span{fill:#000000;color:#000000;}#mermaid-svg-ZJiA1ixGWdsW7rQo .node rect,#mermaid-svg-ZJiA1ixGWdsW7rQo .node circle,#mermaid-svg-ZJiA1ixGWdsW7rQo .node ellipse,#mermaid-svg-ZJiA1ixGWdsW7rQo .node polygon,#mermaid-svg-ZJiA1ixGWdsW7rQo .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .node .label{text-align:center;}#mermaid-svg-ZJiA1ixGWdsW7rQo .node.clickable{cursor:pointer;}#mermaid-svg-ZJiA1ixGWdsW7rQo .arrowheadPath{fill:#333333;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-ZJiA1ixGWdsW7rQo .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-ZJiA1ixGWdsW7rQo .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-ZJiA1ixGWdsW7rQo .cluster text{fill:#333;}#mermaid-svg-ZJiA1ixGWdsW7rQo .cluster span{color:#333;}#mermaid-svg-ZJiA1ixGWdsW7rQo div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-ZJiA1ixGWdsW7rQo:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-ZJiA1ixGWdsW7rQo flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M459.62761306762695,37.054850721282136L70.04861450195312,79.66666793823242L70.04861450195312,114.57986068725586" marker-end="url(https://stackedit.io/app#arrowhead93)" style="fill:none"></path><defs><marker id="arrowhead93" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-H" id="L-B-H" style="opacity: 1;"><path class="path" d="M70.04861450195312,238.6770896911621L70.04861450195312,273.59028244018555L431.23351669311523,313.09637771317637" marker-end="url(https://stackedit.io/app#arrowhead94)" style="fill:none"></path><defs><marker id="arrowhead94" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M459.62761306762695,40.91903292975001L248.1822967529297,79.66666793823242L248.1822967529297,110.54340362548828" marker-end="url(https://stackedit.io/app#arrowhead95)" style="fill:none"></path><defs><marker id="arrowhead95" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-H" id="L-C-H" style="opacity: 1;"><path class="path" d="M248.1822967529297,242.7135467529297L248.1822967529297,273.59028244018555L431.23351669311523,307.13466158142614" marker-end="url(https://stackedit.io/app#arrowhead96)" style="fill:none"></path><defs><marker id="arrowhead96" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-D" id="L-A-D" style="opacity: 1;"><path class="path" d="M470.4097590677579,54.66666793823242L425.9166717529297,79.66666793823242L425.9166717529297,114.97916793823242" marker-end="url(https://stackedit.io/app#arrowhead97)" style="fill:none"></path><defs><marker id="arrowhead97" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-H" id="L-D-H" style="opacity: 1;"><path class="path" d="M425.9166717529297,238.27778244018555L425.9166717529297,273.59028244018555L470.4097590677579,298.59028244018555" marker-end="url(https://stackedit.io/app#arrowhead98)" style="fill:none"></path><defs><marker id="arrowhead98" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-E" id="L-A-E" style="opacity: 1;"><path class="path" d="M553.4635243184725,54.66666793823242L597.9566116333008,79.66666793823242L597.9566116333008,116.23784255981445" marker-end="url(https://stackedit.io/app#arrowhead99)" style="fill:none"></path><defs><marker id="arrowhead99" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-H" id="L-E-H" style="opacity: 1;"><path class="path" d="M597.9566116333008,237.01910781860352L597.9566116333008,273.59028244018555L553.4635243184725,298.59028244018555" marker-end="url(https://stackedit.io/app#arrowhead100)" style="fill:none"></path><defs><marker id="arrowhead100" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-F" id="L-A-F" style="opacity: 1;"><path class="path" d="M564.2456703186035,41.067034648645134L771.6805801391602,79.66666793823242L771.6805801391602,113.29513931274414" marker-end="url(https://stackedit.io/app#arrowhead101)" style="fill:none"></path><defs><marker id="arrowhead101" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-H" id="L-F-H" style="opacity: 1;"><path class="path" d="M771.6805801391602,239.96181106567383L771.6805801391602,273.59028244018555L592.6397666931152,306.90632239153746" marker-end="url(https://stackedit.io/app#arrowhead102)" style="fill:none"></path><defs><marker id="arrowhead102" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-G" id="L-A-G" style="opacity: 1;"><path class="path" d="M564.2456703186035,37.01434009832356L956.9757232666016,79.66666793823242L956.9757232666016,104.66666793823242" marker-end="url(https://stackedit.io/app#arrowhead103)" style="fill:none"></path><defs><marker id="arrowhead103" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-G LE-H" id="L-G-H" style="opacity: 1;"><path class="path" d="M956.9757232666016,248.59028244018555L956.9757232666016,273.59028244018555L592.6397666931152,313.1588780874781" marker-end="url(https://stackedit.io/app#arrowhead104)" style="fill:none"></path><defs><marker id="arrowhead104" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-H" class="edgeLabel L-LS-B' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-H" class="edgeLabel L-LS-C' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-D" class="edgeLabel L-LS-A' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-H" class="edgeLabel L-LS-D' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-E" class="edgeLabel L-LS-A' L-LE-E"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-H" class="edgeLabel L-LS-E' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-F" class="edgeLabel L-LS-A' L-LE-F"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-H" class="edgeLabel L-LS-F' L-LE-H"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-G" class="edgeLabel L-LS-A' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-H" class="edgeLabel L-LS-G' L-LE-H"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-412" transform="translate(511.93664169311523,31.33333396911621)" style="opacity: 1;"><rect rx="0" ry="0" x="-52.30902862548828" y="-23.33333396911621" width="104.61805725097656" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-42.30902862548828,-13.333333969116211)"><foreignObject width="84.61805725097656" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Threat data</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-413" transform="translate(70.04861450195312,176.62847518920898)" style="opacity: 1;"><circle x="-62.048614501953125" y="-50" r="62.048614501953125" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-52.048614501953125,-40)"><foreignObject width="104.09722900390625" height="80"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Common:<br> Base Cybex <br> source fetcher</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-414" transform="translate(511.93664169311523,321.92361640930176)" style="opacity: 1;"><rect rx="0" ry="0" x="-80.703125" y="-23.33333396911621" width="161.40625" height="46.66666793823242" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-70.703125,-13.333333969116211)"><foreignObject width="141.40625" height="26.666667938232422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cybex-P API Module</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-416" transform="translate(248.1822967529297,176.62847518920898)" style="opacity: 1;"><circle x="-66.0850715637207" y="-50" r="66.0850715637207" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-56.0850715637207,-40)"><foreignObject width="112.1701431274414" height="80"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">misp_api:<br> MISP threat<br> intelligence API</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-419" transform="translate(425.9166717529297,176.62847518920898)" style="opacity: 1;"><circle x="-61.64930725097656" y="-36.66666793823242" r="61.64930725097656" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-51.64930725097656,-26.666667938232422)"><foreignObject width="103.29861450195312" height="53.333335876464844"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">misp_file:<br> MISP file input</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-422" transform="translate(597.9566116333008,176.62847518920898)" style="opacity: 1;"><circle x="-60.39063262939453" y="-50" r="60.39063262939453" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-50.39063262939453,-40)"><foreignObject width="100.78125762939453" height="80"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">openphish:<br> Phishing intel <br> patform</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-425" transform="translate(771.6805801391602,176.62847518920898)" style="opacity: 1;"><circle x="-60.755210876464844" y="-63.333335876464844" r="63.333335876464844" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-50.755210876464844,-53.333335876464844)"><foreignObject width="101.51042175292969" height="106.66667175292969"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">phishtank:<br> Community <br> phishing intel <br> platform</div></foreignObject></g></g></g><g class="node default" id="flowchart-G-428" transform="translate(956.9757232666016,176.62847518920898)" style="opacity: 1;"><circle x="-71.96180725097656" y="-50" r="71.96180725097656" class="label-container"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-61.96180725097656,-40)"><foreignObject width="123.92361450195312" height="80"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">websocket:<br> Cybex-P General <br>websocket</div></foreignObject></g></g></g></g></g></g></svg></pre>
<h1 id="plugins">Plugins</h1>
<ul>
<li>
<p><code>Common</code></p>
<ul>
<li>As it’s name states, <code>common</code> is a module that contains common utility and functions that is used by the other plugins within the <code>Cybex-P Input Module</code>.  The following are classes utilized by the other plugins to handle data:</li>
</ul>
<blockquote>
<ul>
<li>CybexSource()</li>
<li>CybexSourceFectcher()</li>
</ul>
</blockquote>
<ul>
<li><em><strong>CybexSource()</strong></em> is <code>common</code>'s class that is responsible for validating input configuration and posting Cybex-P <em><strong>events</strong></em> to the <code>Cybex-P API Module</code>. All modules within the <code>Cybex-P Input Module</code> inherit this class due to the responsibility of posting data to the api being on this module.</li>
<li><em><strong>CybexSourceFetch()</strong></em> is an additional class in <code>common</code> that serves to handle the rate of input from input sources provided by ***CybexSource()***. It executes signal events in multiple threads and executes the signals in those threads based on certain conditions.</li>
</ul>
</li>
<li>
<p><code>misp_api</code></p>
<ul>
<li>Malware Information Share Platform (or MISP) is an open-source platform that provides information on the threat levels and malicious capabilities of threat data provided to it. <code>misp_api</code> is a Cybex-P integration of the platform which utilizes the projects API endpoint to populate Cybex-P’s backend with additional data on any provided threat attribute. The project is integrated into the <code>Cybex-P Input Module</code> by a python wrapper of the platform. The plugin works by simply taking the provided threat data and posting it to the platforms endpoint; the response data, provided it isn’t an error, proceeds to get posted to the <code>Cybex-P API Module</code>.</li>
</ul>
</li>
<li>
<p><code>misp_file</code></p>
<ul>
<li>This plugin acts as a direct input of MISP data. Users who have files available that come from MISP can be inputted through this plugin and easily populated to the <code>Cybex-P API Module</code>.</li>
</ul>
</li>
<li>
<p><code>openphish</code></p>
<ul>
<li>the openphish plugin is a Cybex-P input plugin that actively retrieves URL sources from the openphish platform for the Cybex-P backend. Openphish is a phishing intelligence source that consistently gets updated with URLs that have been flagged as phishing links. This data is populated to the backend of Cybex-P and used as additional attribute data that is correlated to other threat data and sources that is provided to the backend.</li>
</ul>
</li>
<li>
<p><code>phishtank</code></p>
<ul>
<li>like openphish, phishtank is another phishing intelligence platform that offers a community-based phish verification system and users get to vote if the URL should be flagged as a phish. like openphish, phishtank calls are consistently made and data is returned, compressed, in either .bz2 or .gz extension. The data then gets decompressed and comes out in the form a list of records from phishtank. All provided records get posted to the <code>Cybex-P API Module</code>.</li>
</ul>
</li>
<li>
<p><code>websocket</code></p>
<ul>
<li>the websocket plugin is a general purpose plugin with no specific specification directly attached to it. This plugin is used for all other miscellaneous forms of threat data collection. This plugin establishes a connection to the <code>Cybex-P API Module</code> using lomond websocket protocol ws. Use it to connect to the log stash socket module.  The log stash provides information on threat data.</li>
</ul>
</li>
</ul>
<h1 id="miscellaneous">Miscellaneous</h1>
<ul>
<li>PluginHandler
<ul>
<li>deals with the handling of any threads spun up</li>
</ul>
</li>
<li>PluginManager
<ul>
<li>takes care and maintains the sockets of the cybex-p input module
<ul>
<li>Updating socket configurations</li>
<li>Spawning configurations</li>
<li>Restarting sockets</li>
<li>Killing sockets</li>
<li>Checking on the running configs</li>
<li>Initiating and updating to new configs</li>
<li>Running input plugins</li>
<li>Retrieving configurations from files</li>
<li>running the files of input plugins</li>
<li>handling changins</li>
<li>removing stale sockets</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</body>

</html>
